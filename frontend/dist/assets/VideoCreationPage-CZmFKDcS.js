import{r as o,j as e,b as L,u as V,a as P}from"./index-RQDsan70.js";import{s as M,a as z}from"./toast-utils-CGqbRZYm.js";const R=({videoUrl:f,duration:g,segments:n,onSegmentUpdate:N})=>{const[c,S]=o.useState(null),[d,C]=o.useState(null),p=o.useRef(null),b=o.useRef(null),h=s=>{const l=Math.floor(s/60),m=Math.floor(s%60);return`${l}:${m.toString().padStart(2,"0")}`},v=s=>s/g*100,i=s=>{var m;return s/(((m=p.current)==null?void 0:m.clientWidth)||1)*g},r=s=>{if(!p.current)return;const l=p.current.getBoundingClientRect(),m=s.clientX-l.left,w=i(m);b.current&&(b.current.currentTime=w)},x=(s,l)=>m=>{m.stopPropagation(),S(s),C(l)},j=s=>{if(!d||!c||!p.current)return;const l=p.current.getBoundingClientRect(),m=Math.max(0,Math.min(s.clientX-l.left,l.width)),w=i(m),$=n.map(u=>{if(u.id===c){if(d==="start")return{...u,start_time:Math.min(w,u.end_time-1)};if(d==="end")return{...u,end_time:Math.max(w,u.start_time+1)};if(d==="position"){const k=u.end_time-u.start_time,T=Math.max(0,Math.min(w,g-k));return{...u,start_time:T,end_time:T+k}}}return u});N($),b.current&&(b.current.currentTime=w)},E=()=>{C(null)};return o.useEffect(()=>{const s=m=>{d&&j(m)},l=()=>{E()};return document.addEventListener("mousemove",s),document.addEventListener("mouseup",l),()=>{document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",l)}},[d,c]),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"mb-4",children:e.jsx("video",{ref:b,src:f,controls:!0,className:"w-full rounded-lg"})}),e.jsxs("div",{className:"mb-2 flex justify-between text-sm text-gray-500",children:[e.jsx("span",{children:h(0)}),e.jsx("span",{children:h(g/2)}),e.jsx("span",{children:h(g)})]}),e.jsxs("div",{ref:p,className:"relative h-12 bg-gray-200 rounded-lg cursor-pointer",onClick:r,children:[e.jsx("div",{className:"absolute inset-x-0 top-0 flex justify-between px-2",children:Array.from({length:10}).map((s,l)=>e.jsx("div",{className:"h-2 w-px bg-gray-400"},l))}),n.map(s=>e.jsxs("div",{className:`absolute h-8 bottom-0 rounded-md ${s.selected?"bg-blue-500":"bg-blue-300"} ${c===s.id?"ring-2 ring-blue-700":""}`,style:{left:`${v(s.start_time)}%`,width:`${v(s.end_time-s.start_time)}%`},onClick:l=>{l.stopPropagation(),S(s.id)},children:[e.jsx("div",{className:"absolute left-0 top-0 w-2 h-full cursor-ew-resize",onMouseDown:x(s.id,"start")}),e.jsx("div",{className:"absolute right-0 top-0 w-2 h-full cursor-ew-resize",onMouseDown:x(s.id,"end")}),e.jsx("div",{className:"absolute inset-x-2 top-0 h-full cursor-move",onMouseDown:x(s.id,"position"),children:e.jsxs("span",{className:"text-xs text-white px-1 truncate block",children:[h(s.start_time)," - ",h(s.end_time)]})})]},s.id))]})]})},F=({duration:f,onCreateClip:g})=>{const[n,N]=o.useState(0),[c,S]=o.useState(0),[d,C]=o.useState(0),[p,b]=o.useState(10),[h,v]=o.useState(""),i=r=>{r.preventDefault();const x=n*60+c,j=d*60+p;if(j<=x){alert("End time must be after start time");return}if(j>f){alert("End time exceeds video duration");return}g(x,j,h)};return e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"number",min:"0",max:Math.floor(f/60),value:n,onChange:r=>N(parseInt(r.target.value)),className:"w-20 px-3 py-2 border rounded-md"}),e.jsx("span",{className:"mx-2",children:"min"}),e.jsx("input",{type:"number",min:"0",max:"59",value:c,onChange:r=>S(parseInt(r.target.value)),className:"w-20 px-3 py-2 border rounded-md"}),e.jsx("span",{className:"ml-2",children:"sec"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"number",min:"0",max:Math.floor(f/60),value:d,onChange:r=>C(parseInt(r.target.value)),className:"w-20 px-3 py-2 border rounded-md"}),e.jsx("span",{className:"mx-2",children:"min"}),e.jsx("input",{type:"number",min:"0",max:"59",value:p,onChange:r=>b(parseInt(r.target.value)),className:"w-20 px-3 py-2 border rounded-md"}),e.jsx("span",{className:"ml-2",children:"sec"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clip Title"}),e.jsx("input",{type:"text",value:h,onChange:r=>v(r.target.value),placeholder:"Enter a title for your clip",className:"w-full px-3 py-2 border rounded-md",required:!0})]}),e.jsx("button",{type:"submit",className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create Instant Clip"})]})},A=()=>{var k,T,D;const{contentId:f}=L(),g=V(),[n,N]=o.useState(null),[c,S]=o.useState(""),[d,C]=o.useState([]),[p,b]=o.useState(!0),[h,v]=o.useState(!1),[i,r]=o.useState("segments"),[x,j]=o.useState("list");o.useEffect(()=>{(async()=>{try{if(b(!0),f){const a=await P.endpoints.content.getContent(f),y=await P.endpoints.content.getTemplates(),_={id:f,title:"How to Optimize Your LinkedIn Profile",description:"Learn the best practices for creating a standout LinkedIn profile that attracts recruiters and opportunities.",duration:1245,url:"https://example.com/videos/linkedin-tips.mp4",thumbnail_url:"https://via.placeholder.com/640x360?text=LinkedIn+Tips",created_at:"2025-03-20T14:30:00Z",segments:[{id:"1",start_time:0,end_time:120,transcript:"Welcome to this guide on optimizing your LinkedIn profile. Today we'll cover the key elements that make your profile stand out to recruiters and potential connections.",confidence:.95,selected:!1},{id:"2",start_time:121,end_time:240,transcript:"First, let's talk about your profile photo. A professional headshot increases profile views by 14 times. Make sure it's recent and represents how you look in a professional setting.",confidence:.92,selected:!1},{id:"3",start_time:241,end_time:360,transcript:"Next, your headline. Don't just list your job title. Use this space to highlight your expertise and value proposition in 120 characters or less.",confidence:.88,selected:!1},{id:"4",start_time:361,end_time:480,transcript:"Your about section should tell your professional story in a compelling way. Include your achievements, skills, and what you're passionate about.",confidence:.91,selected:!1},{id:"5",start_time:481,end_time:600,transcript:"Skills and endorsements matter. List at least 5 key skills relevant to your industry and ask colleagues to endorse them.",confidence:.94,selected:!1}]},I=[{id:"1",name:"TikTok Explainer",description:"Short, engaging explainer template optimized for TikTok with captions and music.",thumbnail_url:"https://via.placeholder.com/300x500?text=TikTok+Explainer"},{id:"2",name:"Product Showcase",description:"Highlight your product features with this dynamic template.",thumbnail_url:"https://via.placeholder.com/300x500?text=Product+Showcase"},{id:"3",name:"Tutorial Steps",description:"Break down complex processes into simple steps.",thumbnail_url:"https://via.placeholder.com/300x500?text=Tutorial+Steps"}];N((a==null?void 0:a.data)||_),C((y==null?void 0:y.data)||I)}}catch(a){console.error("Error fetching data:",a),M("Failed to load content data")}finally{b(!1)}})()},[f]);const E=t=>{n&&N({...n,segments:n.segments.map(a=>a.id===t?{...a,selected:!a.selected}:a)})},s=t=>{S(t)},l=()=>{if(i==="segments"){if(!(n!=null&&n.segments.some(t=>t.selected))){M("Please select at least one segment");return}r("template")}else if(i==="template"){if(!c){M("Please select a template");return}r("preview")}},m=()=>{i==="template"?r("segments"):i==="preview"&&r("template")},w=async()=>{if(!(!n||!c))try{v(!0);const t=n.segments.filter(a=>a.selected).map(a=>a.id);await P.endpoints.content.createVideo({contentId:n.id,templateId:c,segments:t}),setTimeout(()=>{v(!1),z("Video created successfully!"),g("/")},2e3)}catch(t){console.error("Error creating video:",t),M("Failed to create video"),v(!1)}},$=async(t,a,y)=>{if(n)try{v(!0);const _={id:`instant-${Date.now()}`,start_time:t,end_time:a,transcript:y,confidence:1,selected:!0},I={...n,segments:[_]};N(I),r("template")}catch(_){console.error("Error creating instant clip:",_),M("Failed to create instant clip")}finally{v(!1)}},u=t=>{const a=Math.floor(t/60),y=Math.floor(t%60);return`${a}:${y.toString().padStart(2,"0")}`};return p?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):n?e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:n.title}),e.jsx("p",{className:"text-gray-600",children:n.description})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${i==="segments"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"1"}),e.jsx("div",{className:`flex-1 h-1 mx-2 ${i==="segments"?"bg-gray-200":"bg-blue-600"}`}),e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${i==="template"||i==="preview"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"2"}),e.jsx("div",{className:`flex-1 h-1 mx-2 ${i==="preview"?"bg-blue-600":"bg-gray-200"}`}),e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${i==="preview"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"3"})]}),e.jsxs("div",{className:"flex justify-between mt-2",children:[e.jsx("span",{className:`text-sm ${i==="segments"?"text-blue-600 font-medium":"text-gray-500"}`,children:"Select Segments"}),e.jsx("span",{className:`text-sm ${i==="template"?"text-blue-600 font-medium":"text-gray-500"}`,children:"Choose Template"}),e.jsx("span",{className:`text-sm ${i==="preview"?"text-blue-600 font-medium":"text-gray-500"}`,children:"Preview and Create"})]})]}),i==="segments"&&e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Select Content Segments"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Choose the segments you want to include in your short-form video."}),e.jsxs("div",{className:"flex mt-4 border rounded-lg overflow-hidden",children:[e.jsx("button",{className:`px-4 py-2 flex-1 ${x==="list"?"bg-blue-50 text-blue-600":"bg-white text-gray-600"}`,onClick:()=>j("list"),children:"List View"}),e.jsx("button",{className:`px-4 py-2 flex-1 ${x==="timeline"?"bg-blue-50 text-blue-600":"bg-white text-gray-600"}`,onClick:()=>j("timeline"),children:"Timeline Editor"}),e.jsx("button",{className:`px-4 py-2 flex-1 ${x==="instant"?"bg-blue-50 text-blue-600":"bg-white text-gray-600"}`,onClick:()=>j("instant"),children:"Instant Clip"})]})]}),x==="timeline"&&e.jsx("div",{className:"p-6",children:e.jsx(R,{videoUrl:n.url,duration:n.duration,segments:n.segments,onSegmentUpdate:t=>N({...n,segments:t})})}),x==="instant"&&e.jsx("div",{className:"p-6",children:e.jsx(F,{duration:n.duration,onCreateClip:(t,a,y)=>$(t,a,y)})}),x==="list"&&e.jsx("div",{className:"divide-y",children:n.segments.map(t=>e.jsx("div",{className:`p-6 hover:bg-gray-50 cursor-pointer ${t.selected?"bg-blue-50":""}`,onClick:()=>E(t.id),children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("input",{type:"checkbox",checked:t.selected,onChange:()=>E(t.id),className:"mt-1 h-5 w-5 text-blue-600 rounded"}),e.jsxs("div",{className:"ml-4 flex-grow",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-500",children:[u(t.start_time)," - ",u(t.end_time)]}),e.jsxs("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full",children:[Math.round(t.confidence*100),"% confidence"]})]}),e.jsx("p",{className:"text-gray-700",children:t.transcript})]})]})},t.id))})]}),i==="template"&&e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Choose a Template"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Select a template for your short-form video."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 p-6",children:d.map(t=>e.jsxs("div",{className:`border rounded-lg overflow-hidden cursor-pointer transition-all ${c===t.id?"border-blue-500 ring-2 ring-blue-500 ring-opacity-50":"border-gray-200 hover:border-blue-300"}`,onClick:()=>s(t.id),children:[e.jsx("div",{className:"h-64 bg-gray-100",children:e.jsx("img",{src:t.thumbnail_url,alt:t.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.description})]})]},t.id))})]}),i==="preview"&&e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Preview and Create"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Review your selections and create your short-form video."})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Selected Template"}),e.jsx("div",{className:"flex items-center",children:c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded overflow-hidden",children:e.jsx("img",{src:(k=d.find(t=>t.id===c))==null?void 0:k.thumbnail_url,alt:"Template",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"font-medium",children:(T=d.find(t=>t.id===c))==null?void 0:T.name}),e.jsx("p",{className:"text-sm text-gray-600",children:(D=d.find(t=>t.id===c))==null?void 0:D.description})]})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Selected Segments"}),e.jsx("div",{className:"border rounded-lg divide-y",children:n.segments.filter(t=>t.selected).map(t=>e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"flex justify-between mb-1",children:e.jsxs("span",{className:"text-sm font-medium text-gray-500",children:[u(t.start_time)," - ",u(t.end_time)]})}),e.jsx("p",{className:"text-sm text-gray-700",children:t.transcript})]},t.id))}),n.segments.filter(t=>t.selected).length===0&&e.jsx("p",{className:"text-red-600 text-sm",children:"No segments selected. Please go back and select segments."})]})]})]}),e.jsxs("div",{className:"mt-8 flex justify-between",children:[e.jsx("button",{onClick:m,className:`px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50 ${i==="segments"?"invisible":""}`,children:"Previous"}),i==="preview"?e.jsx("button",{onClick:w,disabled:h||n.segments.filter(t=>t.selected).length===0,className:`px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors ${h||n.segments.filter(t=>t.selected).length===0?"opacity-50 cursor-not-allowed":""}`,children:h?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating Video..."]}):"Create Video"}):e.jsx("button",{onClick:l,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Next"})]})]}):e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"bg-red-50 p-4 rounded-md",children:[e.jsx("p",{className:"text-red-700",children:"Content not found or failed to load."}),e.jsx("button",{onClick:()=>g("/"),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Return to Dashboard"})]})})};export{A as default};
